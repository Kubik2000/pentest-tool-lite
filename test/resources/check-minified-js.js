import sinon from 'sinon';
import outcome from '../../src/outcome';
import checkMinifiedJs from '../../src/resources/checkMinifiedJs.js';

describe('test checkMinifiedJs', function() {
  let sandbox;

  beforeEach(function() {
    sandbox = sinon.sandbox.create();
    sandbox.stub(outcome, 'warning');
    sandbox.stub(outcome, 'error');
  });

  afterEach(function() {
    sandbox.restore();
  });

  it('should log 2 warnings if JS is not minified ang uglified', () => {
    const result = {
      body: 'function something(text) { console.log("not minified javascript file"); }',
    };

    checkMinifiedJs(result);

    sinon.assert.calledTwice(outcome.warning);
  });

  it('should log warning if JS file is minified but not uglified', () => {
    const result = {
      body: 'function something(text){console.log("not minified javascript file")}',
    };

    checkMinifiedJs(result);

    sinon.assert.calledOnce(outcome.warning);
  });
});
