import sinon from 'sinon';
import outcome from '../../src/outcome';
import checkIfAdminLoginPage from '../../src/wordpress/checkIfAdminLoginPage.js';

describe('test checkIfAdminLoginPage', function() {
  let sandbox;

  beforeEach(function() {
    sandbox = sinon.sandbox.create();
    sandbox.stub(outcome, 'error');
  });

  afterEach(function() {
    sandbox.restore();
  });

  it('should log error if WordPress login page', () => {
    const result = {
      body: '<html><head><title>Log in</title></head><body><form name="loginform" id="loginform" action="https://example.com/wp-login.php" method="post"><input type="text" name="log" id="user_login" class="input" value="" size="20" /></label><input type="password" name="pwd" id="user_pass" class="input" value="" size="20" /></label></form></body></html>',
    };

    checkIfAdminLoginPage(result);

    sinon.assert.calledOnce(outcome.error);
  });
});
