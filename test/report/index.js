import chai from 'chai';
const expect = chai.expect;
import report from '../../src/report';

describe('report', function() {
  describe('test report', function() {

    beforeEach(function() {
      report.clear();
    });

    it('should return zero reports', () => {
      const reports = report.getReports();
      expect(reports.length).to.deep.equal(0);
    });

    it('should store and return all reports', () => {
      report.add('Security', 'https://www.juffalow.com', 'X-XSS-Protection header is missing!', 'Description');
      report.add('Security', 'https://www.juffalow.com', 'X-Frame-Options header is missing!', 'Description');
      report.add('Security', 'https://www.juffalow.com', 'Cookies!', 'Description');

      const reports = report.getReports();
      expect(reports).to.deep.equal([
        { namespace: 'Security', url: 'https://www.juffalow.com', text: 'X-XSS-Protection header is missing!', description: 'Description', error: true, importance: 50 },
        { namespace: 'Security', url: 'https://www.juffalow.com', text: 'X-Frame-Options header is missing!', description: 'Description', error: true, importance: 50 },
        { namespace: 'Security', url: 'https://www.juffalow.com', text: 'Cookies!', description: 'Description', error: true, importance: 50 },
      ]);
    });
  });
});
