import chai from 'chai';
const expect = chai.expect;
import checkHttps from '../../../src/security/https/https.js';

describe('security', function() {
  describe('test https function', function() {
    it('should throw error', () => {
      const result = {
        response: {
          headers: {

          },
        },
      };

      expect(checkHttps.bind(null, result)).to.throw();
    });

    it('should throw error if new location is not HTTPS', () => {
      const result = {
        response: {
          headers: {
            'location': 'http://example.com',
          },
          statusCode: 301,
        },
      };

      expect(checkHttps.bind(null, result)).to.throw();
    });

    it('should return without throwing error', () => {
      const result = {
        response: {
          headers: {
            'location': 'https://example.com',
          },
          statusCode: 301,
        },
      };

      expect(checkHttps.bind(null, result)).to.not.throw();
    });
  });
});
