import chai from 'chai';
const expect = chai.expect;
import checkXXSSProtection from '../../../src/security/xxssprotection/xXssProtection.js';

describe('security', function() {
  describe('test xXssOptions function', function() {
    it('should return array with error', () => {
      const result = {
        response: {
          headers: {

          },
        },
      };

      const error = checkXXSSProtection(result);
      expect(error.length).to.equal(1);
    });

    it('should return empty array', () => {
      const result = {
        response: {
          headers: {
            'x-xss-protection': '1;mode=block',
          },
        },
      };

      const error = checkXXSSProtection(result);
      expect(error.length).to.equal(0);
    });
  });
});
