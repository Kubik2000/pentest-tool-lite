import chai from 'chai';
const expect = chai.expect;
import checkCookies from '../../../src/security/cookies/cookies.js';

describe('security', function() {
  describe('test cookies function', function() {
    it('should return array with error', () => {
      const result = {
        response: {
          headers: {
            'set-cookie': [
              'some-token',
              'another-cookie-text; HttpOnly',
            ],
          },
        },
      };

      const error = checkCookies(result);
      expect(error.length).to.equal(1);
    });

    it('should return error if any cookie does not end with secure, HttpOnly', () => {
      const result = {
        response: {
          headers: {
            'set-cookie': [
              'some-token; secure; HttpOnly',
              'another-cookie-text;',
              'whatever; secure; HttpOnly',
            ],
          },
        },
      };
      const error = checkCookies(result);
      expect(error.length).to.equal(1);
    });

    it('should return empty array', () => {
      const result = {
        response: {
          headers: {
            'set-cookie': [
              'some-token; secure; HttpOnly',
              'another-cookie-text; secure; HttpOnly',
            ],
          },
        },
      };

      const error = checkCookies(result);
      expect(error.length).to.equal(0);
    });
  });
});
