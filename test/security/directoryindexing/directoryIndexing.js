import chai from 'chai';
const expect = chai.expect;
import checkDirectoryIndexing from '../../../src/security/directoryindexing/directoryIndexing.js';

describe('security', function() {
  describe('test directoryIndexing function', function() {
    it('should throw error', () => {
      const result = {
        body: '<html><head><title>Index of folder</title></head><body><h1>Index of folder</h1></body></html>',
      };

      expect(checkDirectoryIndexing.bind(null, result)).to.throw();
    });

    it('should return empty array', () => {
      const result = {
        body: '<html><head><title>No index</title></head><body><h1>No index</h1></body></html>',
      };

      expect(checkDirectoryIndexing.bind(null, result)).to.not.throw();
    });
  });
});
