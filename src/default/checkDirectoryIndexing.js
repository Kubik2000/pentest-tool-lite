import request from 'request';
import winston from 'winston';
import outcome from '../outcome';

const checkDirectoryIndexing = function(url) {
  return function() {
    return new Promise(function(resolve, reject) {
      winston.info('Checking Directory Indexing...');

      request(url, function(error, response, body) {
        if (body.indexOf('<title>Index of') > -1 || body.indexOf('<h1>Index of') > -1) {
          outcome.error('default', 'Directory Indexing is enabled!');
        }
        resolve();
      });
    });
  };
};

export default checkDirectoryIndexing;
