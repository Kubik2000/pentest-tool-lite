import checkHttps from './checkHttps.js';
import checkContentSecurityPolicy from './checkContentSecurityPolicy.js';
import checkXSS from './checkXSS.js';
import checkDirectoryIndexing from './checkDirectoryIndexing.js';

const check = function(url) {
  return new function() {
    return new Promise(function(resolve, reject) {
      const chain = Promise.resolve();

      chain.then(checkHttps(url))
        .then(checkContentSecurityPolicy(url))
        .then(checkXSS(url))
        .then(checkDirectoryIndexing(url))
        .then(() => { resolve(); });
    });
  };
};

export default check;
