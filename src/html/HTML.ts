import Test from '../Test';
import Anchor from './Anchor';
import CSS from './CSS';
import DuplicateId from './DuplicateId';
import Image from './Image';
import JavaScript from './JavaScript';

class HTML extends Test {
  protected factory: IFactory;

  constructor(factory: IFactory, config: any) {
    super(config);
    this.factory = factory;
  }

  public async run(url: string): Promise<IResult> {
    const request = this.factory.getRequest();
    const logger = this.factory.getLogger();

    const results = [
      await this.runTest('css', new CSS(request, logger), url),
      await this.runTest('javascript', new JavaScript(request, logger), url),
      await this.runTest('image', new Image(request, logger), url),
      await this.runTest('anchor', new Anchor(request, logger), url),
      await this.runTest('duplicateid', new DuplicateId(request, logger), url),
    ].filter((test) => test !== null);

    return this.getResult('HTML', this.getStatus(results), results);
  }
}

export default HTML;
