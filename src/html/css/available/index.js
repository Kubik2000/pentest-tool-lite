import winston from 'winston';
import * as fetch from '../../../functions/fetch.js';
import checkHttpStatus from '../../../functions/checkHttpStatus.js';
import error from './error';

export default function(javascripts) {
  return new Promise(function(resolve, reject) {
    winston.verbose('Checking resources availability...');

    Promise.all(javascripts.map((url) => {
      return Promise.resolve(url)
        .then(fetch.fetch)
        .then(checkHttpStatus)
        .then(() => {
          return url;
        })
        .catch((err) => {
          error(url, err);
        });
    })).then((urls) => {
      resolve(urls.filter(Boolean));
    });
  });
};
