#!/usr/bin/env node

import program from 'commander';
import winston from 'winston';
import run from './run.js';

process.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';

program
  .version('0.0.9')
  .usage('[options] <URL>')
  .description('Check your website ( or any other website ) for common vulnerabilities.')
  .option('--only-selected', 'run only selected checks')
  .option('--security', 'run security checks')
  .option('--html', 'run html checks')
  .option('--wordpress', 'run wordpress checks')
  .option('-d, --debug', 'debug mode')
  .option('-v, --verbose', 'be more verbose/talkative during the operation')
  .parse(process.argv);

if( program.verbose ) {
  winston.level = 'verbose';
}

if( program.debug ) {
  winston.level = 'debug';
}

if( program.args.length === 0 ) {
  console.error('URL is missing!', 'For help, type pentest-tool-lite --help.');
  process.exit(0);
}

run(program.args[0], program);
