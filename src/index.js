import program from 'commander';
import winston from 'winston';

import defaultChecks from './default';
import wordpressChecks from './wordpress';

import outcome from './outcome';

process.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';

program
  .version('1.1.1')
  .usage('[options] <URL ...>')
  .description('Description')
  .option('-d, --debug', 'debug mode')
  .option('-v, --verbose', 'be more verbose/talkative during the operation')
  .option('-w, --wordpress', 'check wordpress security')
  .parse(process.argv);


if( program.verbose ) {
  winston.level = 'verbose';
}

if( program.debug ) {
  winston.level = 'debug';
}

(new Promise(function(resolve, reject) {
  resolve(program.args[0]);
})).then(() => { return defaultChecks(program.args[0]); })
.then(() => { return program.wordpress ? wordpressChecks(program.args[0]) : null; })
.then(() => { outcome.print(); });
