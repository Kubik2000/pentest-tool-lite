import program from 'commander';

import security from './security';
import wordpress from './wordpress';
import html from './html';

import report from './report';
import plainFormat from './report/format/plain.js';

export default function(url, options) {
  if( !url.endsWith('/') ) {
    url += '/';
  }

  return Promise.resolve((resolve, reject) => {
    console.log('Analyzing', url);
  }).then(() => {
    if (!program.onlySelected || program.security) {
      return Promise.resolve(url)
        .then(security);
    }
    return null;
  }).then(() => {
    if (!program.onlySelected || program.html) {
      return Promise.resolve(url)
        .then(html);
    }
    return null;
  }).then(() => {
    if (!program.onlySelected || program.wordpress) {
      return Promise.resolve(url)
        .then(wordpress);
    }
    return null;
  }).then(() => {
    plainFormat(url, report.getReports());
  });
}
