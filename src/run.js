import program from 'commander';
import pentest from './functions/pentest.js';
import security from './security';
import html from './html';
import wordpress from './wordpress';

import report from './report';
import plainFormat from './report/format/plain.js';
import correctUrl from './functions/correctUrl.js';

export default function(url, options) {
  Promise.resolve(url).then(correctUrl).then((validUrl) => {
    security();
    html();
    wordpress();
    pentest.run(validUrl, program.grep).then(() => {
      plainFormat(validUrl, report.getReports());
    });
  }).catch((error) => {
    if (error.code === 'ENOTFOUND') {
      console.error('URL is not reachable!');
    } else {
      console.error(error);
    }
  });
}
