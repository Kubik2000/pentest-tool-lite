import outcome from '../outcome';
import getObject from '../functions/getObject.js';

export default function(result) {
  const metas = getObject(result, 'name', 'meta');

  const generator = metas.filter((meta) => {
    return meta.hasOwnProperty('attribs') && meta.attribs.hasOwnProperty('name') && meta.attribs.name === 'generator';
  });

  if (generator.length > 0 && generator[0].attribs.content.toLowerCase().startsWith('wordpress')) {
    outcome.warning('wordpress', '', 'WordPress version is visible!');
  }

  return result;
}
