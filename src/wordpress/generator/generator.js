import getObject from '../../functions/getObject.js';

export default function(result) {
  const error = [];

  const metas = getObject(result, 'name', 'meta');

  const generator = metas.filter((meta) => {
    return meta.hasOwnProperty('attribs') && meta.attribs.hasOwnProperty('name') && meta.attribs.name === 'generator';
  });

  if (generator.length > 0 && generator[0].attribs.content.toLowerCase().startsWith('wordpress')) {
    error.push('WordPress version is visible!');
  }

  return error;
}
