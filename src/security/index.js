import pentest from '../functions/pentest.js';
import checkCookies from './cookies';
import checkHttps from './https';
import checkHsts from './hsts';
import checkXFrameOptions from './xframeoptions';
import checkXXSSProtection from './xxssprotection';
import checkDirectoryIndexing from './directoryindexing';
import checkServerFingerprint from './fingerprint';

export default function(url) {
  pentest.namespace('security', function() {
    pentest.add('https', checkHttps);
    checkHsts();
    pentest.add('cookies', checkCookies);
    pentest.add('X-Frame-Options', checkXFrameOptions);
    pentest.add('X-XSS-Protection', checkXXSSProtection);
    pentest.add('Server Fingerprint', checkServerFingerprint);
    pentest.add('Directory Indexing', checkDirectoryIndexing);
  });
};
