export default function(result) {
  if (!result.response.headers.hasOwnProperty('strict-transport-security')) {
    throw new Error('HSTS is not set properly!');
  } else {
    const attributes = result.response.headers['strict-transport-security'].replace(' ', '').split(';');
    const maxAge = attributes.filter((attribute) => { return attribute.startsWith('max-age'); }).shift().replace('max-age=', '');

    if (parseInt(maxAge) < 31536000) {
      throw new Error('Max-age too low!');
    }
  }
};
