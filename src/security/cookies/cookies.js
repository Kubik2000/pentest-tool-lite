/*
 * https://www.owasp.org/index.php/HttpOnly
 * https://www.owasp.org/index.php/SecureFlag
 */
/**
 *
 * @param {Object} result
 */
export default function(result) {
  if (result.response.headers.hasOwnProperty('set-cookie')) {
    const regx = new RegExp('.*(secure; HttpOnly)$', 'i');
    const cookies = result.response.headers['set-cookie'];
    if (typeof cookies === 'object') {
      const unsecure = cookies.filter((cookie) => {
        return !regx.test(cookie);
      });

      if (unsecure.length > 0) {
        return Promise.reject('Missing "secure; httpOnly" flags in cookies!');
      }
    }
  }
};
