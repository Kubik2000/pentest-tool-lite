# Security checks

Basic security checks.

## HTTPS

Make a `GET` request on the same domain but with `http` instead of `https`. The server should respond with redirect ( status code 301 ) on secure version.

**Correct**:

```
Good HTTPS is set properly! http://juffalow.com/
http://juffalow.com/ => https://juffalow.com/
```

**Incorrect**

```
High HTTPS is not set properly! http://juffalow.com/
The page is available only ( or also ) over HTTP. This means it doesn't have any ssl certificate or if it has one, it doesn't force the user to use it.
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#https).
```

## HSTS

Checks if server responds with Strict-Transport-Security header set. The `max-age`
attribute should be set to 2 years, therefore 63072000 seconds.

**Correct**:

```

```

**Incorrect**

If the Strict-Transport-Security header is sent even if loading the page using http,
it logs an error because of unnecessary usage of this header.

```
High Unnecessary HSTS header over HTTP! http://juffalow.com/
The HTTP page at http://juffalow.com/ sends an HSTS header. This has no effect over HTTP, and should be removed.
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#hsts).
```

#### References

* [HTTP Strict Transport Security Cheat Sheet](https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet)
* [hstspreload.org](https://hstspreload.org/)

## Cookies

Checks if each cookie has `secure; httpOnly` flag set.

**Correct**

```
Good Cookies are set properly! https://juffalow.com/
```

**Incorrect**

```
Medium Missing "secure; httpOnly" flags in cookie(s)! https://juffalow.com/
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#cookies).
```

#### References

* [Cookies](https://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Cookies)
* [Set-Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie)
* [How to Create Totally Secure Cookies](http://blog.teamtreehouse.com/how-to-create-totally-secure-cookies)

## Directory indexing

## X-Frame-Options

**Correct**

```
Good X-Frame-Options header is set! https://juffalow.com/
X-Frame-Options: DENY
```

**Incorrect**

```
Medium X-Frame-Options header is missing! https://juffalow.com/
This header is used to avoid Clickjacking attacks. It indicates whether or not a browser should be allowed to render a page in a <frame> or <iframe>.
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#x-frame-options).
```

#### References

* [Clickjacking](https://www.owasp.org/index.php/Clickjacking)
* [Clickjacking Defense Cheat Sheet](https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet)

## X-XSS-Protection

**Correct**

```
Good X-XSS-Protection header is set! https://juffalow.com/
X-XSS-Protection: 1; mode=block
```

**Incorrect**

```
Medium X-XSS-Protection header is missing! https://juffalow.com/
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#x-xss-protection).
```

#### References

 * [Clickjacking](https://www.owasp.org/index.php/Clickjacking)
* [Clickjacking Defense Cheat Sheet](https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet)
* [X-XSS-Protection â€“ Preventing Cross-Site Scripting Attacks](https://www.keycdn.com/blog/x-xss-protection/)
* [X-XSS-Protection](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection)
* [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet)

## Server fingerprint

**Correct**

```
Good No fingerprint header is present! https://juffalow.com/
```

**Incorrect**

```
Medium Server header is present! https://juffalow.com/
There is a header in the HTTP response that disclose the type of a running web server ( and its version ).
For more informations visit [see this page](https://github.com/juffalow/pentest-tool-lite/tree/master/src/security#server-fingerprint).
```

#### References

* [Fingerprint Web Server](https://www.owasp.org/index.php/Fingerprint_Web_Server_(OTG-INFO-002))
